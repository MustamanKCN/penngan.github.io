<!doctype html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href='https://unpkg.com/boxicons@2.1.1/css/boxicons.min.css' rel='stylesheet'>
  <script src="https://code.jquery.com/jquery-3.5.1.js"></script>

  <!-- Bootstrap DatePicker -->
  <link href="https://semicon.github.io/bootstrap-datepicker-thai/css/datepicker.css" rel="stylesheet">
  <script src="https://semicon.github.io/bootstrap-datepicker-thai/js/bootstrap-datepicker.js"></script>
  <script src="https://semicon.github.io/bootstrap-datepicker-thai/js/bootstrap-datepicker-thai.js"></script>
  <script src="https://semicon.github.io/bootstrap-datepicker-thai/js/locales/bootstrap-datepicker.th.js"
    charset="UTF-8"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-loading-overlay/2.1.7/loadingoverlay.min.js"></script>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap-grid.min.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap-grid.rtl.min.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap-reboot.min.css" />
  <?!= include('spiner'); ?>
</head>
<?!=include('css')?>

<body>

  <div id="wrapper">
    <aside id="sidebar-wrapper">
      <div class="sidebar-brand">
        <img id="logo_pic" src="" width="100" style="border-radius: 50%; border-width: 2px; border-style: solid; border-color: gray;" class="mb-2 shadow "  >
        <h2>ระบบงานสารสนเทศโรงเรียน <br><span id="sch_n3"></span></h2>
        <div id="MyClockDisplay" class="clock text-light mt-1 ml-1 " onload="showTime()"></div>
        <? var counter = getCounter(); ?>
        <h6 class="button-71 btn btn-light text-light " style=" background-color:#06635f" id="counterDisplay1">
          <i class="fa-solid fa-users"></i> ผู้เข้าชมเว็บไซต์ :
          <?= counter ?> คน
        </h6>
      </div>

      <ul class="sidebar-nav" style="margin-top:70px;">
        <br>
        <li class="active" id="btn_home99" onclick="reLoad_Page2()">
          <a href="#"><i class='bx bx-home'></i> หน้าหลัก</a>
        </li>

        <!-- // *** เพิ่มเมนูลิ้ง // -->

        <li class="" id="registerbtn_logsch2" style="display:block">
          <a class=" text-dark " href="#"><i class='bx bx-user-plus' ></i> ลงทะเบียน</a>
        </li>

        <li class="" id="adminset1" onclick="loginShow()">
          <a class=" text-dark " href="#"><i class='bx bx-log-in-circle'></i> เข้าสู่ระบบ</a>
        </li>
        <li class="" id="btn_addpro" style="display:none">
          <a class=" text-dark " href="#"><i class='bx bx-add-to-queue' ></i> เพิ่มระบบงาน</a>
        </li>
        <li class="" id="btn_editpro" style="display:none">
          <a class=" text-dark " href="#"><i class='bx bx-edit' ></i> แก้ไขระบบงาน</a>
        </li>

        <li class="" id="adminset3" style="display:none;">
          <a class=" text-dark " href="#"><i class='bx bx-user-plus'></i> อนุมัติผู้ใช้งาน</a>
        </li>

        <li class="" id="setline1" style="display:none">
          <a class=" text-dark " href="#"><i class='bx bx-cog' ></i> ตั้งค่าระบบ</a>
        </li>

        <li class="" id="adminset2" onclick="reLoad_Page()" style="display:none;">
          <a class=" text-dark " href="#"><i class='bx bx-log-out-circle' ></i> ออกจากระบบ</a>
        </li>

        <li class="" onclick="about()" id="click1" style="display:none">
          <a class=" text-dark " href="#"><i class='bx bxs-user-account' ></i> ข้อมูลส่วนตัว</a>
        </li>

        <li class="" onclick="login2()" id="click0" style="display:none">
          <a class=" text-dark " href="#"><i class='bx bx-street-view'></i> นักเรียนประจำชั้น</a>
        </li>

        <li class="" onclick="calendar()" id="click2" style="display:none">
          <a class=" text-dark " href="#"><i class='bx bxs-calendar'></i> ปฏิทินปฏิบัติงาน</a>
        </li>

        <li class="" id="click_Calendar" style="display:block">
          <a class=" text-dark " href="#"><i class='bx bxs-calendar'></i> ปฏิทิน</a>
        </li>




      </ul>



    </aside>



    <div id="navbar-wrapper">
      <nav id="nav2" class=" navbar navbar-inverse">
        <div class="container-fluid">
          <h2><a href="#" class="navbar-brand" id="sidebar-toggle"><i class="fa fa-bars"></i>
              <i class="fa-solid fa-gears fa-lg"></i> ระบบงานสารสนเทศโรงเรียน</a></h2>

          <form class="d-flex" role="search"><span> </span>
            <!-- <img id="picprofile3" src="" style="border-radius:40px; margin-right:10px; border: 2px solid #3fba29;" alt="" width="40" height="40"> -->
            <h5 class="mt-1" style="margin-right:5px; display:none;" id="counterNum">จำนวน</h5>
            <h5 class="mt-1" style="margin-right:5px; display:none;" id="counterDisplay">จำนวนผู้ลงเทะเบียน: 0</h5>


            <script>
              let counter = 0;
            const button = document.getElementById("counterNum");
            const counterDisplay = document.getElementById("counterDisplay");

            button.addEventListener("click", function() {
              counter++;
              counterDisplay.textContent = "จำนวนผู้เข้าชม: " + counter ;
              saveCounter()
            });

            function saveCounter() {
            var counter = 1; // ค่า counter ที่ต้องการเก็บ
            // เรียกใช้ Google Apps Script
            google.script.run.saveCounterToGoogleSheet(counter);
          }
            </script>

            <a id="online1" class="button-71 btn btn- bg-light text-info"
              style="margin-left:10px;display:none"><i class="fa-solid fa-signal"></i>
              <span style="margin-left:5px;" id="sch_n1"></span>
              : ออนไลน์ <img class="bg-warning" id="logo_pic44" style="border-radius:15px;" src="https://cdn.pixabay.com/photo/2020/07/01/12/58/icon-5359553_1280.png" width="30" height="30">
            </a>
            <a id="online2" class="button-71 btn btn- bg-light text-dark" onclick="check_passetlogo()"
              style="margin-left:10px;display:none">

              <i class="fa-solid fa-screwdriver-wrench"></i>
              <a id="offline1" class="button-71 btn btn- bg-light text-dark" style="margin-left:10px;display:block">
                <i class="fa-solid fa-signal"></i> : ออฟไลน์</a>
          </form>
        </div>
      </nav>
    </div>


    <div>
      <?!=include('Calendar')?>
    </div>

    <div>
      <?!=include('pass_mailshow')?>
    </div>

    <div>
      <?!=include('regiter')?>
    </div>

    <div>
      <?!=include('adprograms')?>
    </div>

    <div>
      <?!=include('setting')?>
    </div>



    <!-- ------------------------------------------------------------------------------------------------------------------------------------- -->

    <!-- Modal -->
    <div class="modal-1 modal fade" id="md_table" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-lg">
        <div class="modal-content shadow ">
          <div class="modal-header">
            <h5 class="modal-title"><img src="https://cdn-icons-png.flaticon.com/512/216/216898.png" width="25px" height="25px" /> แก้ไขข้อมูลระบบ
            </h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">

            <section id="content-wrapper">
              <?!=include('dataTable')?>
            </section>

          </div>
        </div>
      </div>
    </div>

    <!-- ------------------------------------------------------------------------------------------------------------------------------------ -->
    <!-- Modal -->
    <div class="modal fade " id="md_dataTable_agree" tabindex="-1" aria-labelledby="exampleModalLabel"
      aria-hidden="true">
      <div class="modal-dialog modal-lg ">
        <div class="modal-content form-box">
          <div class="modal-header">
            <h5 class="modal-title text-primary"><img src="https://images.freeimages.com/fic/images/icons/977/rrze/720/user_admin.png" width="35px" height="30px" /> การอนุมัติบัญชีผู้ใช้
            </h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">

            <section id="content-wrapper">
              <?!=include('dataTable_agree')?>
            </section>

          </div>
        </div>
      </div>
    </div>

    <!-- ------------------------------------------------------------------------------------------------------------------------------------ -->
    <!-- Modal -->
    <div class="modal-open modal fade " id="md_regiter" tabindex="-1" aria-labelledby="exampleModalLabel"
      aria-hidden="true">
      <div class="modal-dialog ">
        <div class="modal-content form-box">
          <div class="modal-header">
            <h5 class="modal-title text-primary"><img src="https://cdn-icons-png.flaticon.com/512/216/216898.png" width="25px" height="25px" /> ลงทะเบียน
            </h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="formregister" onsubmit="saveregister(this)">
              <div class="row">

                <div class="input-group mb-3 ">
                  <span class="input-group-text  " style="width:120px;" id="text1"><b>User :</b></span>
                  <input type="text" class="form-control" id="register_na" name="register_na" placeholder="กำหนด ชื่อผู้ใช้ ภาษาอังกฤษหรือตัวเลข" maxlength="10" >
                </div>
                <div class="input-group mb-3 ">
                  <span class="input-group-text  " style="width:120px;" id="text2"><b>Password :</b></span>
                  <input type="text" class="form-control" id="register_pas" name="register_pas" placeholder="กำหนด รหัสผ่าน ภาษาอังกฤษหรือตัวเลข" maxlength="10" >
                </div>
                <div class="input-group mb-3 ">
                  <span class="input-group-text  " style="width:120px;" id="text3"><b>ชื่อ-สกุล :</b></span>
                  <input type="text" class="form-control" id="register_na2" name="register_na2" placeholder="ชื่อ-สกุล" >
                </div>
                <div id="btn_agree2" class="input-group mb-3 ">
                  <span class="input-group-text  " style="width:120px;" id="text4"><b>อีเมล์ :</b></span>
                  <input type="email" class="form-control" id="register_mail" name="register_mail" placeholder="อีเมล์" >
                </div>
                <div id="btn_agree1" class="input-group mb-3 ">
                  <span class="input-group-text  " style="width:120px;" id="text4"><b>รูปโปรไฟล์ :</b></span>
                  <input type="file" class="form-control" id="profile" name="profile" placeholder="รูปโปรไฟล์" >
                </div>

                <div id="btn_agree" class="input-group mb-3 " style="display:none">
                  <span class="input-group-text  " style="width:120px;" id="text4"><b>การอนุมัติ :</b></span>
                  <!-- <input type="text" class="form-control" id="register_agree" value="รอดำเนินการ" name="register_agree" placeholder="การอนุมัติ" > -->
                  <select class="form-control me-1 bg-light"  id="register_agree"  name="register_agree" class="selectpicker show-tick" >
              <option value="" selected='selected'>ยังไม่อนุมัติ</option>
              <option value="✅อนุมัติแล้ว">อนุมัติ</option>   
              <option value="">ไม่อนุมัติ</option>   
              </select>
                </div>



                <div class="modal-footer">

                  <button type="submit"  id="registerbtn1111" class="button-71 btn btn-primary "><img src="https://cdn-icons-png.flaticon.com/512/3603/3603959.png" width="25px" height="25px" /> ตกลง</button>


                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

    <!-- ------------------------------------------------------------------------------------------------------------------------------------ -->
    <!-- Modal -->
    <div class="modal fade " id="md_adpro" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog ">
        <div class="modal-content form-box">
          <div class="modal-header">
            <h5 class="modal-title text-warning"><img src="https://cdn-icons-png.flaticon.com/512/216/216898.png" width="25px" height="25px" /> เพิ่มระบบโปรแกรม
            </h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="formadpro" onsubmit="saveadpro(this)">
              <div class="row">

                <div class="input-group mb-3 ">
                  <span class="input-group-text  " style="width:120px;" id="text1"><b>ชื่อระบบ :</b></span>
                  <input type="text" class="form-control" id="adpro_na" name="adpro_na" placeholder="ชื่อระบบ" >
                </div>
                <div class="input-group mb-3 " style="display:none">
                  <span class="input-group-text  " style="width:120px;" id="text2"><b>คุณสมบัติระบบ :</b></span>
                  <textarea type="text" rows="4" class="form-control" id="adpro_pas" name="adpro_pas" placeholder="คุณสมบัติระบบร"  ></textarea>
                </div>
                <div class="input-group mb-3 ">
                  <span class="input-group-text  " style="width:120px;" id="text3"><b>Link ระบบโปรแกรม :</b></span>
                  <input type="text" class="form-control" id="adpro_na2" name="adpro_na2" placeholder="Link ระบบโปรแกรม" >
                </div>
                <div class="input-group mb-3 " style="display:none">
                  <span class="input-group-text  " style="width:120px;" id="text4"><b>ลิ้ง ไฟล์ :</b></span>
                  <input type="text" class="form-control" id="adpro_mail" name="adpro_mail" placeholder="ลิ้ง ไฟล์" >
                </div>
                <div class="input-group mb-3 ">
                  <span class="input-group-text  " style="width:120px;" id="text4"><b>ภาพ ระบบโปรแกรม:</b></span>
                  <input type="file" onchange="readURL4(this)"  class="form-control" id="profile_add" name="profile_add" placeholder="ไฟล์ภาพ" >
                </div>
                <center><img id="blah4" src="http://placehold.it/180" alt="your image" width=150px /></center>
                <script>
                  function readURL4(input) {
            if (input.files && input.files[0]) {
                var reader = new FileReader();
                reader.onload = function (e) {
                    $("#blah4")
                        .attr('src', e.target.result);
                };
                reader.readAsDataURL(input.files[0]);
            }
        }
                </script>
                <!-- <div class="input-group mb-3 ">
              <span class="input-group-text  " style="width:280px;" id="text5"><b>หนังสือขอความอนุเคราะห์ หรือ ขอบคุณ :</b></span>
              <input type="file" class="form-control" id="profile2" name="profile2" placeholder="หนังสือขอความอนุเคราะห์ หรือ ขอบคุณ " >
            </div> -->

                <div class="modal-footer">
                  <button type="submit"  id="adprobtn1" class="btn btn-warning "><img src="https://cdn-icons-png.flaticon.com/512/3603/3603959.png" width="25px" height="25px" /> ตกลง</button>


                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

    <!-- -------------------------------------------------------------------------------------------------------------------------------------- -->

    <?!=include('js')?>

    <!-- //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// -->

    <div id="sch_111" style="display:block">
      <br>
      <br>
      <center><img src="" id="logo_pic33" class=" mb-2 shadow border-radius=50%  " alt="" width="200px" height="200px" >
        <h3><b>ระบบงานสารสนเทศโรงเรียน <span id="sch_n34"></span></b></h3>
        <h4> <span id="sch_n33"></span> <span id="sch_n35"></span> </h4>
      </center>
    </div>

    <!-- ******************************************************************************************* -->
    <div class="card container form-box  " id="pcontent" style="display:none;">
      <div class=' justify-content-center  text-center mt-3 '>
        <div class="col-md-auto py-auto  ">
          <div class="col-12 ">
            <div class="container">
              <div class="row justify-content-md-center">

                <!-- *********************************************************************************************** -->
                <div class="container justify-content-center">
                  <h4 align="center" class="mt-2">
                  </h4>
                  <b> <h4 class="text-dark"><i class="fa-brands fa-apple fa-lg"></i> : ระบบงานสารสนเทศโรงเรียน</b></h4>
                  <div class="row">
                    <? getStudent().forEach( row =>{ ?>
                    <div class="col-sm-3 my-2 card11">
                      <div class="card  text-light shadow" style="background-color:#34c9c2">
                        <div class="card-body">

                          <p class="card-text">
                          <div width="100%" class="show_table table-bordered form-control"><img src="<?!= row[2] ?>" width="200px" height="120px" class="card-img-top" alt="..." onclick="select<?!= row[0] ?>()">


                            <h6 class="card-title text-center mt-2 text-warning "
                              style="padding:14px; border-radius:10px; background-color:#06635f">
                              <i class="fa-solid fa-arrow-pointer"></i>
                              <?!= row[1] ?>
                            </h6>

                            <div height="30%" class=" row mt-1 text-center ">

                              <div class=" col-md-7 bg-dark text-center " style="display:none">
                                <a target="_blank" id="btn_999" class="btn btn-dark mt-2" href="<?!= row[4] ?> ">
                                </a>
                              </div>


                              <div class="col-md-12  text-center ">
                                <a target="_blank" class="button-71 btn btn-danger " onclick="select<?!= row[0] ?>()">
                                  <i class="fa-regular fa-hand-pointer"></i> คลิก </a>
                              </div>
                            </div>
                          </div>
                          </p>


                        </div>
                      </div>
                    </div>


                    <template id="formloader">
                      <swal-html>
                        <center>
                          <div class="" id="loader">
                            <span style="width:100%;" class="loader"></span>
                        </center>
                      </swal-html>
                    </template>

                    <script>
                      function formloader3(){
                    Swal.fire({
                    template: '#formloader',
                    showConfirmButton: false,
                    position: 'center',
                    timer: 10000,
                    allowOutsideClick : false,
                      })
                    }
                    function formloader2(){
                    Swal.fire({
                    template: '#formloader',
                    showConfirmButton: false,
                    position: 'center',
                    timer: 2000,
                    allowOutsideClick : false,
                      })
                    }
                    </script>


                    <!-- ปุ่ม sweet alert ที่ขึ้นมาเมื่อกดเลือก -->
                    <script>
                      function select<?!= row[0] ?>(){

                                        Swal.fire({
                                            title: 'เข้าระบบ '+'<?!= row[1] ?>',
                                            imageUrl: '<?!= row[2] ?>',
                                            showCloseButton: false,
                                            showCancelButton: true,
                                            focusConfirm: false,
                                            confirmButtonText: 'ตกลง',
                                            confirmButtonAriaLabel: 'Thumbs up, great!',
                                            confirmButtonColor: '#3d9139',
                                            cancelButtonColor: '#d33',
                                            cancelButtonText:  'ยกเลิก',
                                            imageWidth: 320,
                                            imageHeight: 180,
                                          }).then((result) => {
                                            if (result.isConfirmed) {
                                              document.getElementById('btn_999').click();
                                            }
                                          })
                                          var downloadUrl = "<?!= row[4] ?>";
                                          $('#btn_999').attr('href', downloadUrl).trigger('click');
                                      }
                                  
                    </script>

                    <? });?>
                  </div>
                </div>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
    </br>
    </br>
    </br>
    </br>
    </br>
    <!-- ******************************************************************************************* -->


    <div>
      <?!=include('form_login')?>
    </div>



    <div id="footer" class="flex-shrink-0   div-footer text-center"
      style="position:fixed; bottom:0; width: 100%; background: #34c9c2; ">
      <div class="text-dark text-center" style="text-align: center;">
        <?!= include ('footer') ?>
      </div>
    </div>

    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/11.7.12/sweetalert2.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.min.js"></script>


    <script>
      const $button  = document.querySelector('#sidebar-toggle');
      const $wrapper = document.querySelector('#wrapper');

      $button.addEventListener('click', (e) => {
      e.preventDefault();
      $wrapper.classList.toggle('toggled');
      });
    </script>

    <script>
      function showTime(){
    var date = new Date();
    var h = date.getHours(); // 0 - 23
    var m = date.getMinutes(); // 0 - 59
    var s = date.getSeconds(); // 0 - 59
    var session = "น.";
    
    if(h == 0){
        h = 24;
    }
    
    if(h > 24){
        h = h - 24;
        session = "น.";
    }
    
    h = (h < 10) ? "0" + h : h;
    m = (m < 10) ? "0" + m : m;
    s = (s < 10) ? "0" + s : s;
    
    var time = h + ":" + m + ":" + s + " " + session;
    document.getElementById("MyClockDisplay").innerText = time;
    document.getElementById("MyClockDisplay").textContent = time;
    
    setTimeout(showTime, 1000);
    
}

showTime();

    </script>
</body>

</html>

<style>
  /* Reset CSS */
  /* เมนูด้านข้าง */
  .sidebar-nav {
    background-color: #34c9c2;
    padding: 10px;
    margin-top: 30px;
  }

  .sidebar-nav ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .sidebar-nav li {
    margin-bottom: 10px;
  }

  .sidebar-nav li a {
    display: block;
    color: #333;
    text-decoration: none;
    padding: 5px 10px;
    border-radius: 5px;
    transition: background-color 0.3s ease;
  }

  .sidebar-nav li a:hover {
    background-color: #e0e0e0;
  }

  .sidebar-nav li.active a {
    background-color: #555;
    color: #fff;
  }
</style>

<style>
  #md_dataTable_agree {
    border-radius: 0px;
    background: transparent;
    border: 2px solid rgba(255, 255, 255, 0.5);
    backdrop-filter: blur(15px);

  }

  #md_table {
    border-radius: 0px;
    background: transparent;
    border: 2px solid rgba(255, 255, 255, 0.5);
    backdrop-filter: blur(15px);

  }
</style>